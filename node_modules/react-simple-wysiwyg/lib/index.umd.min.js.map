{"version":3,"file":"index.umd.min.js","sources":["../src/utils.ts","../src/editor/ContentEditable.tsx","../src/editor/EditorContext.tsx","../src/editor/Editor.tsx","../src/toolbar/buttons.tsx","../src/toolbar/icons/UnorderedListIcon.tsx","../src/toolbar/icons/OrderedListIcon.tsx","../src/toolbar/dropdowns.tsx","../src/toolbar/HtmlButton.tsx","../src/toolbar/Separator.tsx","../src/toolbar/Toolbar.tsx","../src/editor/DefaultEditor.tsx"],"sourcesContent":["import type { ForwardedRef } from 'react';\n\nexport function autoconfigureTextDirection(el: HTMLElement | undefined) {\n  if (el) {\n    const text = el.textContent;\n    const rtlPattern = /[\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC]/;\n    el.style.direction = text && rtlPattern.test(text[0]) ? 'rtl' : 'ltr';\n  }\n}\n\nexport function cls(...classNames: unknown[]): string {\n  return classNames.filter(Boolean).join(' ');\n}\n\nexport function getSelectedNode(): Node | undefined {\n  if ((document as any).selection) {\n    return (document as any).selection.createRange().parentElement();\n  }\n\n  const selection = window.getSelection();\n  if (selection && selection.rangeCount > 0) {\n    return selection.getRangeAt(0).startContainer.parentNode || undefined;\n  }\n\n  return undefined;\n}\n\nexport function normalizeHtml(str: string | undefined): string {\n  return str\n    ? str.replace(/&nbsp;|\\u202F|\\u00A0/g, ' ').replace(/<br \\/>/g, '<br>')\n    : '';\n}\n\nexport function replaceCaret(el: HTMLElement) {\n  // Place the caret at the end of the element\n  const target = document.createTextNode('');\n  el.appendChild(target);\n\n  // do not move caret if element was not focused\n  const isTargetFocused = document.activeElement === el;\n  if (target !== null && target.nodeValue !== null && isTargetFocused) {\n    const sel = window.getSelection();\n    if (sel !== null) {\n      const range = document.createRange();\n      range.setStart(target, target.nodeValue.length);\n      range.collapse(true);\n      sel.removeAllRanges();\n      sel.addRange(range);\n    }\n    if (el instanceof HTMLElement) el.focus();\n  }\n}\n\nexport function setForwardRef<T = HTMLDivElement>(\n  el: T,\n  ref?: ForwardedRef<T>,\n) {\n  if (typeof ref === 'function') {\n    ref(el);\n  } else if (typeof ref === 'object' && ref) {\n    // eslint-disable-next-line no-param-reassign\n    ref.current = el;\n  }\n}\n","import React from 'react';\nimport type {\n  FocusEvent,\n  ForwardedRef,\n  HTMLAttributes,\n  KeyboardEvent,\n  SyntheticEvent,\n} from 'react';\nimport {\n  autoconfigureTextDirection,\n  cls,\n  normalizeHtml,\n  replaceCaret,\n  setForwardRef,\n} from '../utils';\n\n/**\n * Based on https://github.com/lovasoa/react-contenteditable\n * A simple component for a html element with editable contents.\n */\nexport const ContentEditable = React.memo(\n  React.forwardRef(function ContentEditable(\n    {\n      // Some properties are used here only as useMemo dependencies\n      className,\n      disabled,\n      tagName,\n      value = '',\n      placeholder,\n      ...rest\n    }: ContentEditableProps,\n    ref: ForwardedRef<HTMLDivElement>,\n  ) {\n    const elRef = React.useRef<HTMLDivElement>();\n    const htmlRef = React.useRef(value);\n    const restRef = React.useRef(rest);\n\n    React.useEffect(() => {\n      restRef.current = rest;\n      const el = elRef.current;\n      if (el && normalizeHtml(htmlRef.current) !== normalizeHtml(value)) {\n        htmlRef.current = value;\n        el.innerHTML = value;\n        replaceCaret(el);\n      }\n    });\n\n    return React.useMemo(() => {\n      function onSetRef($el: HTMLDivElement) {\n        elRef.current = $el;\n        autoconfigureTextDirection($el);\n        setForwardRef($el, ref);\n      }\n\n      function onChange(event: SyntheticEvent<any>) {\n        const el = elRef.current;\n        if (!el) {\n          return;\n        }\n\n        const elementHtml = el.innerHTML;\n        if (elementHtml !== htmlRef.current) {\n          restRef.current.onChange?.({\n            ...event,\n            target: {\n              value: elementHtml,\n              name: rest.name,\n            } as any,\n          });\n        }\n\n        autoconfigureTextDirection(el);\n        htmlRef.current = elementHtml;\n      }\n\n      const cssClass = cls('rsw-ce', className);\n      return React.createElement(tagName || 'div', {\n        ...rest,\n        className: cssClass,\n        contentEditable: !disabled,\n        dangerouslySetInnerHTML: { __html: value },\n        onBlur: (e: FocusEvent<HTMLElement>) =>\n          (restRef.current.onBlur || onChange)(e),\n        onInput: onChange,\n        onKeyDown: (e: KeyboardEvent<HTMLElement>) =>\n          (restRef.current.onKeyDown || onChange)(e),\n        onKeyUp: (e: KeyboardEvent<HTMLElement>) =>\n          (restRef.current.onKeyUp || onChange)(e),\n        placeholder,\n        ref: onSetRef,\n      });\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [className, disabled, placeholder, tagName]);\n  }),\n);\n\nexport type ContentEditableEvent = SyntheticEvent<any, Event> & {\n  target: { name?: string; value: string };\n};\n\nexport interface ContentEditableProps extends HTMLAttributes<HTMLElement> {\n  disabled?: boolean;\n  name?: string;\n  onChange?: (event: ContentEditableEvent) => void;\n  placeholder?: string;\n  tagName?: string;\n  value?: string;\n}\n","import type { ReactNode } from 'react';\nimport React from 'react';\n\nexport const EditorContext = React.createContext<EditorState | undefined>(\n  undefined,\n);\n\nexport function EditorProvider({ children }: { children: ReactNode }) {\n  const [state, setState] = React.useState<EditorState>({\n    htmlMode: false,\n    update,\n  });\n\n  function update(attrs: EditorState) {\n    setState((prevState) => {\n      return {\n        ...prevState,\n        ...attrs,\n      };\n    });\n  }\n\n  return (\n    <EditorContext.Provider value={state}>{children}</EditorContext.Provider>\n  );\n}\n\nexport function useEditorState(): EditorState {\n  const context = React.useContext(EditorContext);\n  if (!context) {\n    throw new Error('You should wrap your component by EditorProvider');\n  }\n\n  return context;\n}\n\nexport interface EditorState {\n  update(attrs: Partial<EditorState>): void;\n  $el?: HTMLElement;\n  $selection?: Node;\n  htmlMode: boolean;\n}\n","import { ComponentProps, ForwardedRef, SyntheticEvent } from 'react';\nimport React from 'react';\nimport { cls, getSelectedNode, setForwardRef } from '../utils';\nimport { ContentEditable, ContentEditableProps } from './ContentEditable';\nimport { useEditorState } from './EditorContext';\nimport '../styles.css';\n\nexport const Editor = React.forwardRef(function Editor(\n  { autoFocus, children, containerProps, onSelect, ...rest }: EditorProps,\n  ref: ForwardedRef<HTMLDivElement>,\n) {\n  const editorState = useEditorState();\n\n  React.useEffect(() => {\n    document.addEventListener('click', onClickOutside);\n    return () => document.removeEventListener('click', onClickOutside);\n  });\n\n  function onClickOutside(event: MouseEvent) {\n    if (event.target === editorState.$el) {\n      return;\n    }\n\n    if (editorState.$el?.contains(event.target as HTMLElement)) {\n      return;\n    }\n\n    editorState.update({ $selection: undefined });\n  }\n\n  function onTextSelect(event: SyntheticEvent<HTMLDivElement>) {\n    onSelect?.(event);\n    editorState.update({ $selection: getSelectedNode() });\n  }\n\n  function setContentEditableRef($el: HTMLDivElement) {\n    editorState.update({ $el });\n    setForwardRef($el, ref);\n    if (autoFocus && $el && editorState.$el === undefined) {\n      $el.focus();\n    }\n  }\n\n  const cssClass = cls('rsw-editor', containerProps?.className);\n\n  if (editorState.htmlMode) {\n    return (\n      <div {...containerProps} className={cssClass}>\n        {children}\n        <textarea {...rest} className=\"rsw-ce rsw-html\" />\n      </div>\n    );\n  }\n\n  return (\n    <div {...containerProps} className={cssClass}>\n      {children}\n      <ContentEditable\n        {...rest}\n        ref={setContentEditableRef}\n        onSelect={onTextSelect}\n      />\n    </div>\n  );\n});\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface EditorProps extends ContentEditableProps {\n  containerProps?: ComponentProps<'div'>;\n}\n","import React from 'react';\nimport type { HTMLAttributes, MouseEvent, ReactNode } from 'react';\nimport { EditorState, useEditorState } from '../editor/EditorContext';\nimport OrderedListIcon from './icons/OrderedListIcon';\nimport UnorderedListIcon from './icons/UnorderedListIcon';\n\nexport const BtnBold = createButton('Bold', 'ùêÅ', 'bold');\n\nexport const BtnBulletList = createButton(\n  'Bullet list',\n  <UnorderedListIcon />,\n  'insertUnorderedList',\n);\n\nexport const BtnClearFormatting = createButton(\n  'Clear formatting',\n  'TÃ≤‚Çì',\n  'removeFormat',\n);\n\nexport const BtnItalic = createButton('Italic', 'ùë∞', 'italic');\n\nexport const BtnStrikeThrough = createButton(\n  'Strike through',\n  <s>ab</s>,\n  'strikeThrough',\n);\n\nexport const BtnLink = createButton('Link', 'üîó', ({ $selection }) => {\n  if ($selection?.nodeName === 'A') {\n    document.execCommand('unlink');\n  } else {\n    // eslint-disable-next-line no-alert\n    document.execCommand('createLink', false, prompt('URL', '') || undefined);\n  }\n});\n\nexport const BtnNumberedList = createButton(\n  'Numbered list',\n  <OrderedListIcon />,\n  'insertOrderedList',\n);\n\nexport const BtnRedo = createButton('Redo', '‚Ü∑', 'redo');\n\nexport const BtnUnderline = createButton(\n  'Underline',\n  <span style={{ textDecoration: 'underline' }}>ùêî</span>,\n  'underline',\n);\n\nexport const BtnUndo = createButton('Undo', '‚Ü∂', 'undo');\n\nexport function createButton(\n  title: string,\n  content: ReactNode,\n  command: ((state: EditorState) => void) | string,\n) {\n  ButtonFactory.displayName = title.replace(/\\s/g, '');\n\n  return ButtonFactory;\n\n  function ButtonFactory(props: HTMLAttributes<HTMLButtonElement>) {\n    const editorState = useEditorState();\n    const { $el, $selection } = editorState;\n\n    let active = false;\n    if (typeof command === 'string') {\n      active = !!$selection && document.queryCommandState(command);\n    }\n\n    function onAction(e: MouseEvent<HTMLButtonElement>) {\n      e.preventDefault();\n\n      if (document.activeElement !== $el) {\n        $el?.focus();\n      }\n\n      if (typeof command === 'function') {\n        command(editorState);\n      } else {\n        document.execCommand(command);\n      }\n    }\n\n    if (editorState.htmlMode) {\n      return null;\n    }\n\n    return (\n      <button\n        className=\"rsw-btn\"\n        data-active={active}\n        onMouseDown={onAction}\n        tabIndex={-1}\n        title={title}\n        type=\"button\"\n        {...props}\n      >\n        {content}\n      </button>\n    );\n  }\n}\n","import React from 'react';\n\nexport default function UnorderedListIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"20\"\n      height=\"20\"\n      viewBox=\"0 0 24 24\"\n      style={{ verticalAlign: 'text-top' }}\n    >\n      <path\n        fill=\"currentColor\"\n        d=\"M7 5h14v2H7V5zm0 8v-2h14v2H7zM4 4.50001c.83 0 1.5.66992 1.5 1.5 0 .83007-.67 1.5-1.5 1.5s-1.5-.66993-1.5-1.5c0-.83008.67-1.5 1.5-1.5zM4 10.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM7 19v-2h14v2H7zm-3-2.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5z\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function OrderedListIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"20\"\n      height=\"20\"\n      viewBox=\"0 0 24 24\"\n      style={{ verticalAlign: 'text-top' }}\n    >\n      <path\n        fill=\"currentColor\"\n        d=\"M6.99938 12.998v-2H20.9994v2H6.99938zm0 6.0001v-2H20.9994v2H6.99938zm0-12.00001v-2H20.9994v2H6.99938zm-4 1v-3h-1v-1h2v4h-1zm-1 9.00001v-1h3v4h-3v-1h2v-.5h-1v-1h1v-.5h-2zM4.25 10c.41421 0 .75.3358.75.75 0 .2024-.08017.3861-.2105.521L3.11983 13H5v1H2v-.9218L4 11H2v-1h2.25z\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\nimport type { ChangeEvent, FC, HTMLAttributes } from 'react';\nimport { EditorState, useEditorState } from '../editor/EditorContext';\n\nexport const BtnStyles = createDropdown('Styles', [\n  ['Normal', 'formatBlock', 'DIV'],\n  ['ùóõùó≤ùóÆùó±ùó≤ùóø ùü≠', 'formatBlock', 'H1'],\n  ['Header 2', 'formatBlock', 'H2'],\n  ['ùô≤ùöòùöçùöé', 'formatBlock', 'PRE'],\n]);\n\nexport function createDropdown(\n  title: string,\n  items: DropDownItem[],\n): FC<DropDownFactoryProps> {\n  DropdownFactory.displayName = title;\n\n  return DropdownFactory;\n\n  function DropdownFactory(props: DropDownFactoryProps) {\n    const editorState = useEditorState();\n    const { $el, $selection, htmlMode } = editorState;\n\n    if (htmlMode) {\n      return null;\n    }\n\n    const activeIndex = items.findIndex(\n      (item) => item[1] === 'formatBlock' && $selection?.nodeName === item[2],\n    );\n\n    return (\n      <Dropdown\n        {...props}\n        items={items}\n        onChange={onChange}\n        selected={activeIndex}\n        tabIndex={-1}\n        title={title}\n      />\n    );\n\n    function onChange(e: ChangeEvent<HTMLSelectElement>) {\n      const target = e.target;\n      const selectedValue = target.value;\n      const selectedIndex = parseInt(selectedValue, 10);\n\n      const [, command, commandArgument] = items[selectedIndex] || [];\n\n      e.preventDefault();\n\n      if (document.activeElement !== $el) {\n        $el?.focus();\n      }\n\n      if (typeof command === 'function') {\n        command(editorState);\n      } else if (command) {\n        document.execCommand(command, false, commandArgument);\n      }\n\n      setTimeout(() => (target.value = selectedValue), 10);\n    }\n  }\n}\n\nexport function Dropdown({ items, selected, ...inputProps }: DropdownProps) {\n  return (\n    <select {...inputProps} value={selected} className=\"rsw-dd\">\n      <option hidden>{inputProps.title}</option>\n      {items.map((item, index) => (\n        <option key={item[2]} value={index}>\n          {item[0]}\n        </option>\n      ))}\n    </select>\n  );\n}\n\nexport type DropDownItem = [\n  string,\n  string | ((editorState: EditorState) => void),\n  string,\n];\n\nexport interface DropDownFactoryProps\n  extends HTMLAttributes<HTMLSelectElement> {\n  selected?: number;\n}\n\nexport interface DropdownProps extends DropDownFactoryProps {\n  items: DropDownItem[];\n}\n","import React from 'react';\nimport { useEditorState } from '../editor/EditorContext';\n\nexport function HtmlButton({ ...rest }) {\n  const editorState = useEditorState();\n\n  function onClick() {\n    editorState.update({\n      htmlMode: !editorState.htmlMode,\n    });\n  }\n\n  return (\n    <button\n      className=\"rsw-btn\"\n      data-active={editorState.htmlMode}\n      onClick={onClick}\n      tabIndex={-1}\n      title=\"HTML mode\"\n      type=\"button\"\n      {...rest}\n    >\n      &lt;/&gt;\n    </button>\n  );\n}\n","import React from 'react';\nimport { useEditorState } from '../editor/EditorContext';\n\nexport function Separator() {\n  const editorState = useEditorState();\n\n  if (editorState.htmlMode) {\n    return null;\n  }\n\n  return <div className=\"rsw-separator\" />;\n}\n","import React from 'react';\nimport { HTMLAttributes } from 'react';\n\nexport function Toolbar(props: HTMLAttributes<HTMLDivElement>) {\n  return <div {...props} className=\"rsw-toolbar\" />;\n}\n","import React, { type ForwardedRef } from 'react';\nimport { Editor, EditorProps } from './Editor';\nimport { EditorProvider } from './EditorContext';\nimport {\n  BtnBold,\n  BtnBulletList,\n  BtnClearFormatting,\n  BtnItalic,\n  BtnLink,\n  BtnNumberedList,\n  BtnRedo,\n  BtnStrikeThrough,\n  BtnStyles,\n  BtnUnderline,\n  BtnUndo,\n  HtmlButton,\n  Separator,\n  Toolbar,\n} from '../toolbar';\n\nexport const DefaultEditor = React.forwardRef(function DefaultEditor(\n  props: EditorProps,\n  ref: ForwardedRef<HTMLDivElement>,\n) {\n  return (\n    <EditorProvider>\n      <Editor {...props} ref={ref}>\n        <Toolbar>\n          <BtnUndo />\n          <BtnRedo />\n          <Separator />\n          <BtnBold />\n          <BtnItalic />\n          <BtnUnderline />\n          <BtnStrikeThrough />\n          <Separator />\n          <BtnNumberedList />\n          <BtnBulletList />\n          <Separator />\n          <BtnLink />\n          <BtnClearFormatting />\n          <HtmlButton />\n          <Separator />\n          <BtnStyles />\n        </Toolbar>\n      </Editor>\n    </EditorProvider>\n  );\n});\n"],"names":["autoconfigureTextDirection","el","text","textContent","style","direction","test","cls","classNames","_i","arguments","length","filter","Boolean","join","getSelectedNode","document","selection","createRange","parentElement","window","getSelection","rangeCount","getRangeAt","startContainer","parentNode","normalizeHtml","str","replace","setForwardRef","ref","current","ContentEditable","React","memo","forwardRef","_a","className","disabled","tagName","_b","value","placeholder","rest","__rest","elRef","useRef","htmlRef","restRef","useEffect","innerHTML","target","createTextNode","appendChild","isTargetFocused","activeElement","nodeValue","sel","range","setStart","collapse","removeAllRanges","addRange","HTMLElement","focus","replaceCaret","useMemo","onChange","event","elementHtml","call","__assign","name","cssClass","createElement","contentEditable","dangerouslySetInnerHTML","__html","onBlur","e","onInput","onKeyDown","onKeyUp","$el","EditorContext","createContext","undefined","EditorProvider","children","useState","htmlMode","update","attrs","setState","prevState","state","Provider","useEditorState","context","useContext","Error","Editor","autoFocus","containerProps","onSelect","editorState","onClickOutside","contains","$selection","addEventListener","removeEventListener","BtnBold","createButton","BtnBulletList","xmlns","width","height","viewBox","verticalAlign","fill","d","BtnClearFormatting","BtnItalic","BtnStrikeThrough","BtnLink","nodeName","execCommand","prompt","BtnNumberedList","BtnRedo","BtnUnderline","textDecoration","BtnUndo","title","content","command","ButtonFactory","displayName","props","active","queryCommandState","onMouseDown","preventDefault","tabIndex","type","BtnStyles","createDropdown","items","DropdownFactory","activeIndex","findIndex","item","Dropdown","selectedValue","selectedIndex","parseInt","commandArgument","setTimeout","selected","inputProps","hidden","map","index","key","HtmlButton","onClick","Separator","Toolbar","DefaultEditor"],"mappings":"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"}